FROM centos:7

RUN yum update -y && yum install -y gcc gcc-c++ make wget python3 python3-devel

RUN wget https://download.osgeo.org/proj/proj-4.9.1.tar.gz && tar xvzf proj-4.9.1.tar.gz && \
    cd proj-4.9.1 && mkdir ../proj && ./configure --prefix=/proj/Proj.4 && make && make install

RUN yum install -y https://download1.rpmfusion.org/free/el/rpmfusion-free-release-7.noarch.rpm && \
    yum install -y libgeos-dev geos geos-devel

RUN pip3 install Cython numpy geopandas geopy rasterio

RUN export PATH=/proj/Proj.4/bin:$PATH && export LD_LIBRARY_PATH=/proj/proj-4.9.1/lib:$LD_LIBRARY_PATH && \
    pip3 install --global-option=build_ext --global-option="-I/proj/Proj.4/include" geolib

ENV PATH="/proj/Proj.4/bin:${PATH}"

ENV LD_LIBRARY_PATH="/proj/Proj.4/lib:${LD_LIBRARY_PATH}"

CMD ["/bin/bash"]